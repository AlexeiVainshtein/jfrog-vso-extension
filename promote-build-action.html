 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <title>Promote sample</title>
 </head>
 <body>
	 <script src="lib/VSS.SDK.js"></script>
 <script>
      VSS.init({
        explicitNotifyLoaded: true, 
        usePlatformScripts: true
    });
    
     VSS.notifyLoadSucceeded();
    
    var menuContributionHandler = (function () {
         "use strict";
         return {
             // This is a callback that gets invoked when a user clicks the newly contributed menu item
             // The actionContext parameter contains context data surrounding the circumstances of this
             // action getting invoked.
             execute: function (actionContext) {
	    VSS.getService(VSS.ServiceIds.Dialog).then(function(dialogService) {
        var extensionCtx = VSS.getExtensionContext();
        //build absolute contribution id for dialogContent
        var contributionId = extensionCtx.publisherId + "." + extensionCtx.extensionId + ".promoteBuildDialog";
        
        //Show dialog
        var dialogOptions = {
          title: "Promote this build to JFrog Artifactory",
          width: 400,
          height: 300,
          buttons: null,
          urlReplacementObject: {buildId: actionContext.id}  
        };
        
        dialogService.openDialog(contributionId, dialogOptions);
    });
             }
         };
    }());
     // Associate the menuContributionHandler object with the "myAction" menu contribution from the manifest.
     VSS.register("promote-build-action", menuContributionHandler);
     
    //   // Use an IIFE to create an object that satisfies the IContributedMenuSource contract
    //   var menuContributionHandler = (function () {
    //      "use strict";
    //      return {
    //          // This is a callback that gets invoked when a user clicks the newly contributed menu item
    //          // The actionContext parameter contains context data surrounding the circumstances of this
    //          // action getting invoked.
    //          execute: function (actionContext) {
    //             // Get the Web Context to create the uri
    //             var vstsContext = VSS.getWebContext();
    //             // Navigate to the new View Assoicated Work Items hub.
    //             // Fabrikam is the extension's namespace and Fabrikam.HelloWorld is the hub's id.
    //             var extensionContext = VSS.getExtensionContext();
    //                       
    //             var promoteJson = '{"status": "staged", "comment" : "Tested on all target platforms.", "ciUser": "jroquelaure", "timestamp" : "ISO8601", "dryRun" : false, "copy": false, "artifacts" : true, "dependencies" : true, "properties": { "components":["c1","c3","c14"], "release-name": ["fb3-ga"] }, "failFast": false}';          
    //             
    //             $.ajax({
    //                 method: 'POST',
    //                 contentType: 'application/json; charset=utf-8',
    //                 url: 'https://internalsandbox.artifactoryonline.com/internalsandbox/api/build/promote/mavenTest/78',
    //                 beforeSend: function (xhr) {
    //                     xhr.setRequestHeader ("Authorization", "Basic " + btoa("vso-deployer" + ":" + "VS0Deployer31"));
    //                 },
    //                 async: false,
    //                 data: promoteJson,
    //                 success: function( response ){
    //                     var i = response;
    //                     alert("prommotion succeed");
    //                 },
    //                 error: function(jqXHR, exception)
    //                 {
    //                     alert('error');
    //                 }
    //                    
    //             });    
    //                           
    //           
    //          }
    //      };
    //  }());

     // Associate the menuContributionHandler object with the "myAction" menu contribution from the manifest.
     //VSS.register("promoteToArtifactory", menuContributionHandler);
 </script>
     <div>
         The end user doesn't see the content on this page.
         It is only in the background to handle the contributed menu item being clicked.
     </div>
 </body>
 </html>